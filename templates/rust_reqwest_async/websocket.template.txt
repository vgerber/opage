pub struct {{ struct_name }} {
    socket: WebSocket<MaybeTlsStream<TcpStream>>,
}

impl {{ struct_name }} {
    pub fn from(socket: WebSocket<MaybeTlsStream<TcpStream>>) -> Self {
        {{ struct_name }} { socket: socket }
    }

    pub fn close(&mut self, code: Option<CloseFrame>) -> Result<(), Error> {
        self.socket.close(code)
    }

    pub fn read(&mut self) -> Result<{response_type_name}, String> {
        let response = match self.socket.read() {
            Ok(response) => response,
            Err(err) => return Err(err.to_string()),
        };

        let response_text = match response.into_text() {
            Ok(response) => response,
            Err(err) => return Err(err.to_string()),
        };

        let result = match serde_json::from_str::<serde_json::Value>(&response_text) {
            Ok(response_json_object) => response_json_object,
            Err(err) => return Err(err.to_string()),
        };

        let response_object = match result.get("result") {
            Some(response_object) => response_object,
            None => return Err("No result in message".to_string()),
        };

        match serde_json::from_value::<{response_type_name}>(response_object.clone()) {
            Ok(response_object) => Ok(response_object),
            Err(err) => return Err(err.to_string()),
        }
    }
}